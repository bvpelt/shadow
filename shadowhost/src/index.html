<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Showdowhost</title>
  <base href="/">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" type="image/x-icon" href="favicon.ico">
</head>

<body>
  <script>

    function parseHTML(html) {
      var t = document.createElement('template');
      t.innerHTML = html;
      return t.content.cloneNode(true);
    }

    customElements.define(
      'dso-view',
      class extends HTMLElement {
        connectedCallback() {
          var shadow = null;
          const url = this.getAttribute('url');

          shadow = this.attachShadow({ mode: 'open' }); // container is just a div
          shadow.innerHTML = "<app-root class='dso'></app-root>";

          var tag = document.createElement('script');
          tag.src = url + "/runtime.971b49795bf37ec0.js";
          tag.defer = true;
          shadow.append(tag);


          tag = document.createElement('script');
          tag.src = url + "/polyfills.198f79c3c673d0f7.js";
          tag.defer = true;
          shadow.append(tag)



          tag = document.createElement('script');
          tag.src = url + "/main.c3631db9343791d3.js";
          tag.defer = true;
          shadow.append(tag)

          console.log(shadow.innerHTML);
          /*
          const headers = {
            'Sec-Fetch-Site': 'none'
          };

          const options = {
            'method': 'GET',
            'mode': 'no-cors',
            //            'site': 'none',
            //            'headers': headers
          };

          fetch(url, options)
            .then((response) => {
              if (!response.ok) {
                console.log('HTTP error - status: ' + response.status + ' - ok: ' + status.ok);
                throw new Error("HTTP error " + response.status);
              } else {
                console.log('HTTP result: ' + response.json());
              }
              return response.json();
            })
            .then((json) => {
              shadow = this.attachShadow({ mode: 'open' }); // container is just a div
              shadow.innerHTML = "<app-root></app-root>";
              //shadow.appendChild(html);


              //            shadow.append(html);

              //var your_html_element = parseHTML(html);
              //shadow.appendChild(your_html_element);
              //shadow.append(json);
              //console.log('Appended child to shadow: ' + json);

              var tag = document.createElement('script');
              tag.src = url + "/runtime.971b49795bf37ec0.js";
              tag.defer = true;
              shadow.append(tag);

              //              tag = document.createElement('script');
              //              tag.src = url + "/polyfills-es5.1a4928232678b73b212e.js";
              //              tag.nomodule = true;
              //              tag.defer = true;
              //              shadow.append(tag);

              tag = document.createElement('script');
              tag.src = url + "/polyfills.198f79c3c673d0f7.js";
              tag.defer = true;
              shadow.append(tag)

              //              tag = document.createElement('script');
              //              tag.src = url + "/scripts.cb9c1c75fdd88cce0ad3.js";
              //              tag.defer = true;
              //              shadow.append(tag)

              tag = document.createElement('script');
              tag.src = url + "/main.5a4d27717359b7bd.js";
              tag.defer = true;
              shadow.append(tag)

              console.log(shadow.innerHTML);
            })
            .catch(err => {
              console.log('Error during fetch: ' + err);
            })
            ;
            */
        }
      });

  </script>
  <app-root>
  </app-root>
</body>

</html>
